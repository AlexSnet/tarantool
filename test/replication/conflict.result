box.schema.user.grant('guest', 'replication')
---
...
reset master-master replication
box.schema.user.grant('guest', 'replication')
---
...
space = box.schema.space.create('test')
---
...
index = space:create_index('primary', { type = 'tree'})
---
...
for k = 1, 9 do space:insert{k, k*k} end
---
...
box.info().replication.status
---
- connected
...
box.info().replication.message
---
- null
...
box.space.test:select{}
---
- - [1, 1]
  - [2, 4]
  - [3, 9]
  - [4, 16]
  - [5, 25]
  - [6, 36]
  - [7, 49]
  - [8, 64]
  - [9, 81]
...
box.info().replication.status
---
- connected
...
box.info().replication.message
---
- null
...
box.space.test:select{}
---
- - [1, 1]
  - [2, 4]
  - [3, 9]
  - [4, 16]
  - [5, 25]
  - [6, 36]
  - [7, 49]
  - [8, 64]
  - [9, 81]
...
parallel send: box.space.test:update(1, {{'#', 2, 1}})
parallel send: box.space.test:update(1, {{'#', 2, 1}})
box.info().replication.status
---
- stopped
...
box.info().replication.message
---
- Field 2 was not found in the tuple
...
box.space.test:select{}
---
- - [1]
  - [2, 4]
  - [3, 9]
  - [4, 16]
  - [5, 25]
  - [6, 36]
  - [7, 49]
  - [8, 64]
  - [9, 81]
...
box.info().replication.status
---
- stopped
...
box.info().replication.message
---
- Field 2 was not found in the tuple
...
box.space.test:select{}
---
- - [1]
  - [2, 4]
  - [3, 9]
  - [4, 16]
  - [5, 25]
  - [6, 36]
  - [7, 49]
  - [8, 64]
  - [9, 81]
...
reset master-master replication
box.schema.user.grant('guest', 'replication')
---
...
space = box.schema.space.create('test')
---
...
index = space:create_index('primary', { type = 'tree'})
---
...
for k = 1, 9 do space:insert{k, k*k} end
---
...
box.info().replication.status
---
- connected
...
box.info().replication.message
---
- null
...
box.space.test:select{}
---
- - [1, 1]
  - [2, 4]
  - [3, 9]
  - [4, 16]
  - [5, 25]
  - [6, 36]
  - [7, 49]
  - [8, 64]
  - [9, 81]
...
box.info().replication.status
---
- connected
...
box.info().replication.message
---
- null
...
box.space.test:select{}
---
- - [1, 1]
  - [2, 4]
  - [3, 9]
  - [4, 16]
  - [5, 25]
  - [6, 36]
  - [7, 49]
  - [8, 64]
  - [9, 81]
...
parallel send: box.space.test:insert{20, 1}
parallel send: box.space.test:insert{20, 2}
box.info().replication.status
---
- stopped
...
box.info().replication.message
---
- Duplicate key exists in unique index 'primary' in space 'test'
...
box.space.test:select{}
---
- - [1, 1]
  - [2, 4]
  - [3, 9]
  - [4, 16]
  - [5, 25]
  - [6, 36]
  - [7, 49]
  - [8, 64]
  - [9, 81]
  - [20, 1]
...
box.info().replication.status
---
- stopped
...
box.info().replication.message
---
- Duplicate key exists in unique index 'primary' in space 'test'
...
box.space.test:select{}
---
- - [1, 1]
  - [2, 4]
  - [3, 9]
  - [4, 16]
  - [5, 25]
  - [6, 36]
  - [7, 49]
  - [8, 64]
  - [9, 81]
  - [20, 2]
...
reset master-master replication
box.schema.user.grant('guest', 'replication')
---
...
space = box.schema.space.create('test')
---
...
index = space:create_index('primary', { type = 'tree'})
---
...
for k = 1, 9 do space:insert{k, k*k} end
---
...
box.info().replication.status
---
- connected
...
box.info().replication.message
---
- null
...
box.space.test:select{}
---
- - [1, 1]
  - [2, 4]
  - [3, 9]
  - [4, 16]
  - [5, 25]
  - [6, 36]
  - [7, 49]
  - [8, 64]
  - [9, 81]
...
box.info().replication.status
---
- connected
...
box.info().replication.message
---
- null
...
box.space.test:select{}
---
- - [1, 1]
  - [2, 4]
  - [3, 9]
  - [4, 16]
  - [5, 25]
  - [6, 36]
  - [7, 49]
  - [8, 64]
  - [9, 81]
...
parallel send: box.space.test:auto_increment{1}
parallel send: box.space.test:auto_increment{2}
box.info().replication.status
---
- stopped
...
box.info().replication.message
---
- Duplicate key exists in unique index 'primary' in space 'test'
...
box.space.test:select{}
---
- - [1, 1]
  - [2, 4]
  - [3, 9]
  - [4, 16]
  - [5, 25]
  - [6, 36]
  - [7, 49]
  - [8, 64]
  - [9, 81]
  - [10, 1]
...
box.info().replication.status
---
- stopped
...
box.info().replication.message
---
- Duplicate key exists in unique index 'primary' in space 'test'
...
box.space.test:select{}
---
- - [1, 1]
  - [2, 4]
  - [3, 9]
  - [4, 16]
  - [5, 25]
  - [6, 36]
  - [7, 49]
  - [8, 64]
  - [9, 81]
  - [10, 2]
...
reset master-master replication
box.schema.user.grant('guest', 'replication')
---
...
space = box.schema.space.create('test')
---
...
index = space:create_index('primary', { type = 'tree'})
---
...
for k = 1, 9 do space:insert{k, k*k} end
---
...
box.info().replication.status
---
- connected
...
box.info().replication.message
---
- null
...
box.space.test:select{}
---
- - [1, 1]
  - [2, 4]
  - [3, 9]
  - [4, 16]
  - [5, 25]
  - [6, 36]
  - [7, 49]
  - [8, 64]
  - [9, 81]
...
box.info().replication.status
---
- connected
...
box.info().replication.message
---
- null
...
box.space.test:select{}
---
- - [1, 1]
  - [2, 4]
  - [3, 9]
  - [4, 16]
  - [5, 25]
  - [6, 36]
  - [7, 49]
  - [8, 64]
  - [9, 81]
...
parallel send: box.space.test:update(1, {{'+', 2, 1}})
parallel send: box.space.test:update(1, {{'+', 2, 2}})
box.info().replication.status
---
- connected
...
box.info().replication.message
---
- null
...
box.space.test:select{}
---
- - [1, 4]
  - [2, 4]
  - [3, 9]
  - [4, 16]
  - [5, 25]
  - [6, 36]
  - [7, 49]
  - [8, 64]
  - [9, 81]
...
box.info().replication.status
---
- connected
...
box.info().replication.message
---
- null
...
box.space.test:select{}
---
- - [1, 4]
  - [2, 4]
  - [3, 9]
  - [4, 16]
  - [5, 25]
  - [6, 36]
  - [7, 49]
  - [8, 64]
  - [9, 81]
...
reset master-master replication
box.schema.user.grant('guest', 'replication')
---
...
space = box.schema.space.create('test')
---
...
index = space:create_index('primary', { type = 'tree'})
---
...
for k = 1, 9 do space:insert{k, k*k} end
---
...
box.info().replication.status
---
- connected
...
box.info().replication.message
---
- null
...
box.space.test:select{}
---
- - [1, 1]
  - [2, 4]
  - [3, 9]
  - [4, 16]
  - [5, 25]
  - [6, 36]
  - [7, 49]
  - [8, 64]
  - [9, 81]
...
box.info().replication.status
---
- connected
...
box.info().replication.message
---
- null
...
box.space.test:select{}
---
- - [1, 1]
  - [2, 4]
  - [3, 9]
  - [4, 16]
  - [5, 25]
  - [6, 36]
  - [7, 49]
  - [8, 64]
  - [9, 81]
...
parallel send: box.space.test:delete(999)
parallel send: box.space.test:delete(999)
box.info().replication.status
---
- connected
...
box.info().replication.message
---
- null
...
box.space.test:select{}
---
- - [1, 1]
  - [2, 4]
  - [3, 9]
  - [4, 16]
  - [5, 25]
  - [6, 36]
  - [7, 49]
  - [8, 64]
  - [9, 81]
...
box.info().replication.status
---
- connected
...
box.info().replication.message
---
- null
...
box.space.test:select{}
---
- - [1, 1]
  - [2, 4]
  - [3, 9]
  - [4, 16]
  - [5, 25]
  - [6, 36]
  - [7, 49]
  - [8, 64]
  - [9, 81]
...
